--- a/net/minecraft/server/network/ServerConfigurationPacketListenerImpl.java
+++ b/net/minecraft/server/network/ServerConfigurationPacketListenerImpl.java
@@ -44,8 +44,8 @@
     private ConfigurationTask currentTask;
     private ClientInformation clientInformation;
 
-    public ServerConfigurationPacketListenerImpl(MinecraftServer minecraftserver, Connection connection, CommonListenerCookie commonlistenercookie) {
-        super(minecraftserver, connection, commonlistenercookie);
+    public ServerConfigurationPacketListenerImpl(MinecraftServer minecraftserver, Connection networkmanager, CommonListenerCookie commonlistenercookie, ServerPlayer player) { // CraftBukkit
+        super(minecraftserver, networkmanager, commonlistenercookie, player); // CraftBukkit
         this.gameProfile = commonlistenercookie.gameProfile();
         this.clientInformation = commonlistenercookie.clientInformation();
     }
@@ -123,14 +117,14 @@
                 return;
             }
 
-            Component component = playerlist.canPlayerLogin(this.connection.getRemoteAddress(), this.gameProfile);
+            Component ichatbasecomponent = null; // CraftBukkit - login checks already completed
 
             if (component != null) {
                 this.disconnect(component);
                 return;
             }
 
-            ServerPlayer serverplayer = playerlist.getPlayerForLogin(this.gameProfile, this.clientInformation);
+            ServerPlayer entityplayer = playerlist.getPlayerForLogin(this.gameProfile, this.clientInformation, this.player); // CraftBukkit
 
             playerlist.placeNewPlayer(this.connection, serverplayer, this.createCookie(this.clientInformation));
             this.connection.resumeInboundAfterProtocolChange();
