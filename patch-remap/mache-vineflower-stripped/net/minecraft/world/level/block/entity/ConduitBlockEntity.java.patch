--- a/net/minecraft/world/level/block/entity/ConduitBlockEntity.java
+++ b/net/minecraft/world/level/block/entity/ConduitBlockEntity.java
@@ -25,6 +26,10 @@
 import net.minecraft.world.level.block.state.BlockState;
 import net.minecraft.world.phys.AABB;
 import net.minecraft.world.phys.Vec3;
+// CraftBukkit start
+import org.bukkit.craftbukkit.block.CraftBlock;
+import org.bukkit.craftbukkit.event.CraftEventFactory;
+// CraftBukkit end
 
 public class ConduitBlockEntity extends BlockEntity {
     private static final int BLOCK_REFRESH_RATE = 2;
@@ -167,19 +190,22 @@
     }
 
     private static void applyEffects(Level level, BlockPos pos, List<BlockPos> positions) {
-        int size = positions.size();
-        int i = size / 7 * 16;
-        int x = pos.getX();
-        int y = pos.getY();
-        int z = pos.getZ();
-        AABB aABB = new AABB((double)x, (double)y, (double)z, (double)(x + 1), (double)(y + 1), (double)(z + 1))
-            .inflate((double)i)
-            .expandTowards(0.0, (double)level.getHeight(), 0.0);
-        List<Player> entitiesOfClass = level.getEntitiesOfClass(Player.class, aABB);
-        if (!entitiesOfClass.isEmpty()) {
-            for (Player player : entitiesOfClass) {
-                if (pos.closerThan(player.blockPosition(), (double)i) && player.isInWaterOrRain()) {
-                    player.addEffect(new MobEffectInstance(MobEffects.CONDUIT_POWER, 260, 0, true, true));
+        int i = positions.size();
+        int j = i / 7 * 16;
+        int k = pos.getX();
+        int l = pos.getY();
+        int i1 = pos.getZ();
+        AABB axisalignedbb = (new AABB((double) k, (double) l, (double) i1, (double) (k + 1), (double) (l + 1), (double) (i1 + 1))).inflate((double) j).expandTowards(0.0D, (double) level.getHeight(), 0.0D);
+        List<Player> list1 = level.getEntitiesOfClass(Player.class, axisalignedbb);
+
+        if (!list1.isEmpty()) {
+            Iterator iterator = list1.iterator();
+
+            while (iterator.hasNext()) {
+                Player entityhuman = (Player) iterator.next();
+
+                if (pos.closerThan(entityhuman.blockPosition(), (double) j) && entityhuman.isInWaterOrRain()) {
+                    entityhuman.addEffect(new MobEffectInstance(MobEffects.CONDUIT_POWER, 260, 0, true, true), org.bukkit.event.entity.EntityPotionEffectEvent.Cause.CONDUIT); // CraftBukkit
                 }
             }
         }
@@ -205,17 +234,13 @@
         }
 
         if (blockEntity.destroyTarget != null) {
-            level.playSound(
-                null,
-                blockEntity.destroyTarget.getX(),
-                blockEntity.destroyTarget.getY(),
-                blockEntity.destroyTarget.getZ(),
-                SoundEvents.CONDUIT_ATTACK_TARGET,
-                SoundSource.BLOCKS,
-                1.0F,
-                1.0F
-            );
-            blockEntity.destroyTarget.hurt(level.damageSources().magic(), 4.0F);
+            // CraftBukkit start
+            CraftEventFactory.blockDamage = CraftBlock.at(level, pos);
+            if (blockEntity.destroyTarget.hurt(level.damageSources().magic(), 4.0F)) {
+                level.playSound((Player) null, blockEntity.destroyTarget.getX(), blockEntity.destroyTarget.getY(), blockEntity.destroyTarget.getZ(), SoundEvents.CONDUIT_ATTACK_TARGET, SoundSource.BLOCKS, 1.0F, 1.0F);
+            }
+            CraftEventFactory.blockDamage = null;
+            // CraftBukkit end
         }
 
         if (livingEntity != blockEntity.destroyTarget) {
