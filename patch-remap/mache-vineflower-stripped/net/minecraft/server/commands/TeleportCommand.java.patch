--- a/net/minecraft/server/commands/TeleportCommand.java
+++ b/net/minecraft/server/commands/TeleportCommand.java
@@ -31,6 +32,12 @@
 import net.minecraft.world.level.Level;
 import net.minecraft.world.phys.Vec2;
 import net.minecraft.world.phys.Vec3;
+// CraftBukkit start
+import org.bukkit.Location;
+import org.bukkit.craftbukkit.CraftWorld;
+import org.bukkit.event.entity.EntityTeleportEvent;
+import org.bukkit.event.player.PlayerTeleportEvent;
+// CraftBukkit end
 
 public class TeleportCommand {
     private static final SimpleCommandExceptionType INVALID_POSITION = new SimpleCommandExceptionType(
@@ -278,15 +158,48 @@
         if (!Level.isInSpawnableBounds(blockPos)) {
             throw INVALID_POSITION.create();
         } else {
-            float f = Mth.wrapDegrees(yaw);
-            float f1 = Mth.wrapDegrees(pitch);
-            if (entity.teleportTo(level, x, y, z, relativeList, f, f1)) {
-                if (facing != null) {
-                    facing.perform(source, entity);
+            float f2 = Mth.wrapDegrees(z);
+            float f3 = Mth.wrapDegrees(f1);
+
+            // CraftBukkit start - Teleport event
+            boolean result;
+            if (entity instanceof ServerPlayer player) {
+                result = player.teleportTo(level, x, d1, y, set, f2, f3, PlayerTeleportEvent.TeleportCause.COMMAND);
+            } else {
+                Location to = new Location(level.getWorld(), x, d1, y, f2, f3);
+                EntityTeleportEvent event = new EntityTeleportEvent(entity.getBukkitEntity(), entity.getBukkitEntity().getLocation(), to);
+                level.getCraftServer().getPluginManager().callEvent(event);
+                if (event.isCancelled()) {
+                    return;
                 }
 
-                if (!(entity instanceof LivingEntity livingEntity) || !livingEntity.isFallFlying()) {
-                    entity.setDeltaMovement(entity.getDeltaMovement().multiply(1.0, 0.0, 1.0));
+                x = to.getX();
+                d1 = to.getY();
+                y = to.getZ();
+                f2 = to.getYaw();
+                f3 = to.getPitch();
+                level = ((CraftWorld) to.getWorld()).getHandle();
+
+                result = entity.teleportTo(level, x, d1, y, set, f2, f3);
+            }
+
+            if (result) {
+                // CraftBukkit end
+                if (relativeList != null) {
+                    relativeList.perform(source, entity);
+                }
+
+                label23:
+                {
+                    if (entity instanceof LivingEntity) {
+                        LivingEntity entityliving = (LivingEntity) entity;
+
+                        if (entityliving.isFallFlying()) {
+                            break label23;
+                        }
+                    }
+
+                    entity.setDeltaMovement(entity.getDeltaMovement().multiply(1.0D, 0.0D, 1.0D));
                     entity.setOnGround(true);
                 }
 
